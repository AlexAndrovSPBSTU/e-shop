# e-shop
Интернет магазин

## Разрабочики
- [Алексей](https://github.com/AlexAndrovSPBSTU) (backend)
  - База данных
  - Сервер
  - Docker
- [Максим](https://github.com/MaksSTV) (frontend)
  - S3 хранилище
  - Клиентская часть
  - Docker
---
## Используемый стек
- DB
  - PostgreSql
- Backend
  - Java 8
  - Spring 5
  - Hibernate ORM
  - Postman
- S3 server
  - @aws-sdk/client-s3
  - express
  - multer
- Frontend
  - Vue 3
  - Vite (сборщик)
  - Vuetify (UI Kit)
  - Vue-router
  - Vuex
  - Vee-validate + Yup
- DevOps
  - Docker
  - Docker-compose

---
Взаимодействие "клиент-сервер" реализовано по HTTP протоколу с помощью архитектуры REST API
---

Разработка проекта велась с активным развитием github репозитория

Issues:


![img](https://storage.yandexcloud.net/e-shop/issue.JPG)

Pull Requests:


![img](https://storage.yandexcloud.net/e-shop/pullRequest.JPG)

  

## Инструкция по сборке 

Перед запуском необходимо скачать и запустить Docker Engine.
В папке Doсker находится всё необходимое для развёртки проекта на локальной машине.

docker-compose.yml - файл позволяющий запускать все контейнеры вместе\
create_tables.sql - файл для создания бд\
fill_tables.sql - файл для заполенения бд

\
Чтобы запустить все контейнеры вместе достаточно выполнить следующую команду:
```
docker-compose up
```
\
\
Структура базы данных представлена ниже.
\
\
![database_model.png](backend%2Fsrc%2Fmain%2Fresources%2Fdatabase_model.png)

# Таблица Customer.
У Customer может быть несколько комментариев, товаров в корзине (CartItem) и совершённые покупки.

# Таблица Comment.
Одному комментарию соответсвует один продукт и пользователь, который его оставил. 

# Таблица Photo.
Фотография обязательно должна ссылать или на продукт или на комментарий в котором она используется.

# Таблица Photo.
Фотография обязательно должна ссылать или на продукт или на комментарий в котором она используется.

# Таблица CartItem.
В этой таблице хранятся товары и их кол-во, которые пользователь хочет приобрести. (Корзина) 
Когда пользователь добавляет товар в корзину,
новой сущности cartItem в purchase_id присваивается 1. Это id ничейной покупки, она создаётся в бд при запуске докера.
Сделано это по той причине, что это primary key и ему должно быть присвоено какое-то занчение. 
Когда покупка состоится, этой сущности cartItem в purchase_id присвоится id состоявшейся покупки.

# Таблица Product.
Продукт может находиться только в одной категории.

# Таблица Category.
Одна категория может находиться в нескольких категориях.

# Таблица Characteristics.
Характеристика принадлежит только одной категории. Все хар-ки родительской категории наследуются дочерними категориями, 
если isDiverged = false. Если хар-ка диапазончатая, то у неё обязательно должны быть поля from и to.

# Таблица Property.
Это те значения хар-ки, которые могут принимать товары. К примеру "Объём оперативной памяти" - хар-ка. "4 ГБ",
"8 ГБ" - её значения. Эти значения относятся только к этой хар-ки. Помимого прочего товары могут состоять из этих 
значение(отношение многие ко многим).

\
По указанной ссылке можно найти все методы api в postman-е.\
https://www.postman.com/martian-meadow-737952/workspace/e-shop/collection/27254100-6a2c8515-5874-4c2c-9845-d64f6953290e?action=share&creator=27254100

# Клиентская часть

### Основые страницы

| Названия                |              url примеры              |
| :---------------------- | :-----------------------------------: |
| Приветственная страница |        http://localhost:3000/         |
| Каталог                 | /categories/2/products?page=1&order=4 |
| Карточка товара         |              /products/2              |
| Корзина                 |                /bucket                |
| Админ панель            |                /admin                 |
| Регистрация             |               /register               |
| Авторизация             |                /login                 |

## Приветственная страница
Простой пример главной страницы, с которой можно перейти в каталог через активные блоки под слайдеров.

Также почти на каждой странице есть шапка в которой есть дерево каталога, который можно разворачивать и использовать его, чтобы перейти на интересующий раздел. Отсюда можно перейти в корзину, войти в аккаунт или пройти регистрацию, или выйти из аккаунта. Если это администратор, то перейти в панель администратора.

![img](https://storage.yandexcloud.net/e-shop/firstPage.JPG)
## Каталог
 * Каталог имеет блок с фильтрами по характеристикам, которые принадлежат этой категории.
 * Список можно отсортировать по 4 параметрам - По рейтингу, по скидке, сначала дешевле, сначала дороже
 * Реализован infinite scroll

 ![img](https://storage.yandexcloud.net/e-shop/catalogPage.JPG)

## Карточка товара

Карточка конкретного товара, имеет полное описание про него, которое имеется в базе. Характиристики и свойства товара, цена и наличие на складе.

* Сделаны хлебные крошки
* Слайдер изображений товара
* Блок с отзывами

 ![img](https://storage.yandexcloud.net/e-shop/itemPage_1.JPG)

### Отзывы
 * Можно читать отзывы
 * Сортировать их по рейтингу 
 * Раскрывать фото

Можно оставить отзыв, с рейтингом, также можно загрузить фото к этому отзыву.

Если пользователь это администратор, то он может удалить комментарий полностью, также может удалить фото внутри комментария. 

 ![img](https://storage.yandexcloud.net/e-shop/itemPage_2.JPG)

## Корзина

Список товаров, которые пользователь добавил в корзину.\
Реализовано:
* Добавление поштучно
* Удаление поштучно
* Удаление полностью одноименные товары
* Отмечать галочкой те товары, которые собираемся купить

 ![img](https://storage.yandexcloud.net/e-shop/bucketPage_info.JPG)

Если при оформлении покупки, какого-то товара больше нет в базе или не хватает по количеству, то выведется ошибка с подстветкой тех товаров, которых или уже нет, или не хватает.

 ![img](https://storage.yandexcloud.net/e-shop/bucketPage_error.JPG)

Если покупка была произедена, то появится уведомление об этом, и приобретенные товары исчезут из корзины.

<u>При покупке сервер посылает письмо на почту пользователя</u>

## Админ панель

Минималистичная страничка, в которой выводится информация об админе, а также реализовано полное взаимодействие с сайтом через админ панель.

![img](https://storage.yandexcloud.net/e-shop/admin_1.JPG)

Реализовано:
* Товары
  * Добавление
  * Удаление
  * Редактирование
  * Добавление свойств в товар
* Каталог
  * Добавление категории
  * Удаление
  * Переименование
  * Перемещение
* Характеристики
  * Добавление
  * Удаление
  * Переименование
* Свойства
  * Добавление
  * Удаление
  * Переименование

![img](https://storage.yandexcloud.net/e-shop/admin_2.JPG)
  
  Пример работы с панелью:

  ![img](https://storage.yandexcloud.net/e-shop/admin_3.JPG)


## Регистрация

Страница с регистрацией нового пользователя на сайте.

![img](https://storage.yandexcloud.net/e-shop/register.JPG)

Если такой пользователь уже существует, клиент увидит ошибку

![img](https://storage.yandexcloud.net/e-shop/register_error.JPG)

## Авторизация

Страница с авторизацией пользователя на сайте.

![img](https://storage.yandexcloud.net/e-shop/login.JPG)

Если произошла ошибка при аутентификации, пользователь увидит ошибку

![img](https://storage.yandexcloud.net/e-shop/login_error.JPG)

# S3 хранилище

Было создано s3 хранилище на Yandex Cloud, в котором лежат изображения для этого проекта, куда загружаются фотографии из отзывов, или же при работе админа по добавлении фото или редактировании списка фото в товарах.
Даже изображения из этого readme файла лежат в хранилище.

Было изучено то, как пользоватся хранилищем через http протокол.

Без использования сторонних решений, были написаны функции и контроллер для взаимодействия клиент-s3_server-cloud

![img](https://storage.yandexcloud.net/e-shop/s3.JPG)